<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B√†i t·∫≠p 3: Countdown Timer - 211A210020</title>
    <link rel="stylesheet" href="css/style.css">
    <style>
        .timer-container {
            max-width: 800px;
            margin: 40px auto;
            text-align: center;
        }

        .timer-display {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 60px 40px;
            border-radius: 20px;
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.4);
            margin-bottom: 30px;
        }

        .timer-label {
            font-size: 1.5em;
            margin-bottom: 20px;
            opacity: 0.9;
        }

        .timer-time {
            font-size: 8em;
            font-weight: bold;
            font-family: 'Courier New', monospace;
            letter-spacing: 10px;
            margin: 20px 0;
            text-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .timer-warning {
            animation: pulse 1s infinite;
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
        }

        .timer-description {
            font-size: 1.2em;
            opacity: 0.8;
        }

        .timer-controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 30px;
        }

        .timer-controls button {
            padding: 15px 40px;
            font-size: 1.1em;
            min-width: 150px;
        }

        .btn-start {
            background: linear-gradient(135deg, #27ae60 0%, #229954 100%);
        }

        .btn-pause {
            background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%);
        }

        .btn-reset {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
        }

        .timer-settings {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 15px;
            margin-top: 40px;
        }

        .timer-settings h3 {
            color: #667eea;
            margin-bottom: 20px;
        }

        .settings-group {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
        }

        .settings-group input {
            width: 100px;
            text-align: center;
        }

        /* Modal styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            animation: fadeIn 0.3s ease;
        }

        .modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: white;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            max-width: 500px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            animation: scaleIn 0.3s ease;
        }

        @keyframes scaleIn {
            from {
                transform: scale(0.8);
                opacity: 0;
            }
            to {
                transform: scale(1);
                opacity: 1;
            }
        }

        .modal-content h2 {
            color: #e74c3c;
            font-size: 3em;
            margin-bottom: 20px;
        }

        .modal-content p {
            font-size: 1.3em;
            margin-bottom: 30px;
            color: #666;
        }

        .modal-close {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 15px 40px;
            font-size: 1.1em;
        }

        .timer-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-top: 40px;
        }

        .stat-box {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 3px 15px rgba(0, 0, 0, 0.1);
        }

        .stat-box h4 {
            color: #667eea;
            margin-bottom: 10px;
            font-size: 0.9em;
        }

        .stat-box .stat-value {
            font-size: 2em;
            font-weight: bold;
            color: #333;
        }

        .explanation {
            background: #e8f4f8;
            border-left: 5px solid #667eea;
            padding: 20px;
            margin: 30px 0;
            border-radius: 5px;
        }

        .explanation h3 {
            color: #667eea;
            margin-bottom: 15px;
        }

        .explanation ul {
            margin-left: 20px;
            line-height: 1.8;
        }

        @media (max-width: 768px) {
            .timer-time {
                font-size: 4em;
                letter-spacing: 5px;
            }

            .timer-controls {
                flex-direction: column;
            }

            .timer-controls button {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>‚è∞ B√†i t·∫≠p 3: Countdown Timer</h1>
            <p>ƒê·ªìng h·ªì ƒë·∫øm ng∆∞·ª£c 10 ph√∫t</p>
        </header>

        <nav>
            <ul>
                <li><a href="index.html">üè† Trang ch·ªß</a></li>
                <li><a href="baitap01.html">üì¶ B√†i 1: S·∫£n ph·∫©m</a></li>
                <li><a href="baitap02.html">üìù B√†i 2: Form ƒëƒÉng k√Ω</a></li>
                <li><a href="baitap03.html">‚è±Ô∏è B√†i 3: Countdown</a></li>
                <li><a href="about.html">‚ÑπÔ∏è Gi·ªõi thi·ªáu</a></li>
                <li><a href="contact.html">üìß Li√™n h·ªá</a></li>
            </ul>
        </nav>

        <main>
            <div class="timer-container fade-in">
                <div class="timer-display" id="timerDisplay">
                    <div class="timer-label">‚è±Ô∏è Th·ªùi gian c√≤n l·∫°i</div>
                    <div class="timer-time" id="timerTime">10:00</div>
                    <div class="timer-description" id="timerStatus">Nh·∫•n Start ƒë·ªÉ b·∫Øt ƒë·∫ßu ƒë·∫øm ng∆∞·ª£c</div>
                </div>

                <div class="timer-controls">
                    <button class="btn-start" id="startBtn">‚ñ∂Ô∏è Start</button>
                    <button class="btn-pause" id="pauseBtn" disabled>‚è∏Ô∏è Pause</button>
                    <button class="btn-reset" id="resetBtn">üîÑ Reset</button>
                </div>

                <div class="timer-settings">
                    <h3>‚öôÔ∏è C√†i ƒë·∫∑t th·ªùi gian</h3>
                    <div class="settings-group">
                        <label for="minutesInput">Ph√∫t:</label>
                        <input type="number" id="minutesInput" value="10" min="0" max="60">
                        <label for="secondsInput">Gi√¢y:</label>
                        <input type="number" id="secondsInput" value="0" min="0" max="59">
                        <button onclick="applySettings()">√Åp d·ª•ng</button>
                    </div>
                </div>

                <div class="timer-stats">
                    <div class="stat-box">
                        <h4>S·ªë l·∫ßn kh·ªüi ƒë·ªông</h4>
                        <div class="stat-value" id="startCount">0</div>
                    </div>
                    <div class="stat-box">
                        <h4>T·ªïng th·ªùi gian ch·∫°y</h4>
                        <div class="stat-value" id="totalTimeRun">0:00</div>
                    </div>
                    <div class="stat-box">
                        <h4>Tr·∫°ng th√°i</h4>
                        <div class="stat-value" id="timerState">Stopped</div>
                    </div>
                </div>
            </div>

            <div class="explanation">
                <h3>üí° Logic t∆∞ duy l·∫≠p tr√¨nh</h3>
                <h4>1. X·ª≠ l√Ω interval ƒë·ªÉ tr√°nh memory leak:</h4>
                <ul>
                    <li><strong>clearInterval():</strong> Lu√¥n clear interval tr∆∞·ªõc khi t·∫°o m·ªõi ƒë·ªÉ tr√°nh multiple timers</li>
                    <li><strong>Global variable:</strong> L∆∞u intervalId ·ªü scope global ƒë·ªÉ c√≥ th·ªÉ clear t·ª´ b·∫•t k·ª≥ function n√†o</li>
                    <li><strong>Check existence:</strong> Ki·ªÉm tra interval ƒë√£ t·ªìn t·∫°i tr∆∞·ªõc khi start/pause</li>
                </ul>

                <h4>2. T√≠nh to√°n th·ªùi gian ch√≠nh x√°c:</h4>
                <ul>
                    <li><strong>Seconds-based:</strong> L∆∞u th·ªùi gian d∆∞·ªõi d·∫°ng gi√¢y ƒë·ªÉ t√≠nh to√°n d·ªÖ d√†ng</li>
                    <li><strong>Format MM:SS:</strong> S·ª≠ d·ª•ng Math.floor() v√† modulo (%) ƒë·ªÉ chuy·ªÉn ƒë·ªïi</li>
                    <li><strong>padStart():</strong> ƒê·∫£m b·∫£o lu√¥n hi·ªÉn th·ªã 2 ch·ªØ s·ªë (01, 02... thay v√¨ 1, 2...)</li>
                </ul>

                <h4>3. Animation v√† UX:</h4>
                <ul>
                    <li><strong>CSS Animation:</strong> S·ª≠ d·ª•ng @keyframes pulse khi d∆∞·ªõi 1 ph√∫t</li>
                    <li><strong>Dynamic class:</strong> Th√™m/x√≥a class ƒë·ªÉ trigger animation</li>
                    <li><strong>Visual feedback:</strong> ƒê·ªïi m√†u n·ªÅn khi c·∫£nh b√°o th·ªùi gian</li>
                </ul>

                <h4>4. T√≠ch h·ª£p Domain/Hosting:</h4>
                <ul>
                    <li><strong>Kh√¥ng c·∫ßn server:</strong> Timer ch·∫°y ho√†n to√†n client-side v·ªõi JavaScript</li>
                    <li><strong>Static hosting:</strong> Deploy d·ªÖ d√†ng l√™n GitHub Pages, Netlify, Vercel</li>
                    <li><strong>ƒê·ªìng b·ªô th·ªùi gian:</strong> Trong production, c√≥ th·ªÉ sync v·ªõi server time qua API</li>
                    <li><strong>Offline-capable:</strong> Ho·∫°t ƒë·ªông ngay c·∫£ khi offline (PWA)</li>
                </ul>

                <h4>5. Best practices:</h4>
                <ul>
                    <li>Disable/Enable buttons theo tr·∫°ng th√°i timer</li>
                    <li>Modal alert thay v√¨ alert() native ƒë·ªÉ UX t·ªët h∆°n</li>
                    <li>Responsive design cho mobile</li>
                    <li>Tracking statistics (s·ªë l·∫ßn start, t·ªïng th·ªùi gian...)</li>
                </ul>
            </div>
        </main>

        <footer>
            <p>&copy; 2026 - B√†i t·∫≠p 3: Countdown Timer | 211A210020 - Phan Th·ªã Y·∫øn Nhi</p>
        </footer>
    </div>

    <!-- Modal h·∫øt th·ªùi gian -->
    <div id="timeUpModal" class="modal">
        <div class="modal-content">
            <h2>‚è∞</h2>
            <p><strong>H·∫øt th·ªùi gian!</strong></p>
            <p>ƒê·ªìng h·ªì ƒë·∫øm ng∆∞·ª£c ƒë√£ k·∫øt th√∫c.</p>
            <button class="modal-close" onclick="closeModal()">ƒê√≥ng</button>
        </div>
    </div>

    <script src="js/script.js"></script>
    <script>
        // ===== GLOBAL VARIABLES =====
        let totalSeconds = 10 * 60; // 10 ph√∫t = 600 gi√¢y
        let remainingSeconds = totalSeconds;
        let intervalId = null;
        let isRunning = false;
        let isPaused = false;
        let startCount = 0;
        let totalTimeElapsed = 0;

        // ===== DOM ELEMENTS =====
        const timerTime = document.getElementById('timerTime');
        const timerDisplay = document.getElementById('timerDisplay');
        const timerStatus = document.getElementById('timerStatus');
        const startBtn = document.getElementById('startBtn');
        const pauseBtn = document.getElementById('pauseBtn');
        const resetBtn = document.getElementById('resetBtn');
        const modal = document.getElementById('timeUpModal');

        // ===== FORMAT TIME MM:SS =====
        function formatTime(seconds) {
            const minutes = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${String(minutes).padStart(2, '0')}:${String(secs).padStart(2, '0')}`;
        }

        // ===== UPDATE DISPLAY =====
        function updateDisplay() {
            timerTime.textContent = formatTime(remainingSeconds);
            
            // Animation c·∫£nh b√°o khi d∆∞·ªõi 1 ph√∫t (60 gi√¢y)
            if (remainingSeconds <= 60 && remainingSeconds > 0) {
                timerDisplay.classList.add('timer-warning');
                timerStatus.textContent = '‚ö†Ô∏è Th·ªùi gian s·∫Øp h·∫øt!';
            } else if (remainingSeconds > 60) {
                timerDisplay.classList.remove('timer-warning');
                timerStatus.textContent = isRunning ? 'ƒêang ƒë·∫øm ng∆∞·ª£c...' : 'T·∫°m d·ª´ng';
            }

            // Update stats
            updateStats();
        }

        // ===== UPDATE STATISTICS =====
        function updateStats() {
            document.getElementById('startCount').textContent = startCount;
            document.getElementById('totalTimeRun').textContent = formatTime(totalTimeElapsed);
            document.getElementById('timerState').textContent = 
                isRunning ? 'Running' : (isPaused ? 'Paused' : 'Stopped');
        }

        // ===== START TIMER =====
        function startTimer() {
            if (isRunning) return; // ƒê√£ ch·∫°y r·ªìi th√¨ kh√¥ng start n·ªØa

            isRunning = true;
            isPaused = false;
            startCount++;
            
            startBtn.disabled = true;
            pauseBtn.disabled = false;
            
            timerStatus.textContent = 'ƒêang ƒë·∫øm ng∆∞·ª£c...';

            // Clear interval c≈© (n·∫øu c√≥) ƒë·ªÉ tr√°nh memory leak
            if (intervalId) {
                clearInterval(intervalId);
            }

            // T·∫°o interval m·ªõi
            intervalId = setInterval(() => {
                remainingSeconds--;
                totalTimeElapsed++;
                updateDisplay();

                // Ki·ªÉm tra h·∫øt th·ªùi gian
                if (remainingSeconds <= 0) {
                    stopTimer();
                    showTimeUpModal();
                }
            }, 1000);

            updateStats();
        }

        // ===== PAUSE TIMER =====
        function pauseTimer() {
            if (!isRunning) return;

            isRunning = false;
            isPaused = true;

            // Clear interval ƒë·ªÉ tr√°nh memory leak
            if (intervalId) {
                clearInterval(intervalId);
                intervalId = null;
            }

            startBtn.disabled = false;
            pauseBtn.disabled = true;
            startBtn.textContent = '‚ñ∂Ô∏è Resume';
            
            timerStatus.textContent = 'T·∫°m d·ª´ng';
            updateStats();
        }

        // ===== STOP TIMER =====
        function stopTimer() {
            isRunning = false;
            isPaused = false;

            // Clear interval ƒë·ªÉ tr√°nh memory leak
            if (intervalId) {
                clearInterval(intervalId);
                intervalId = null;
            }

            startBtn.disabled = false;
            pauseBtn.disabled = true;
            
            updateStats();
        }

        // ===== RESET TIMER =====
        function resetTimer() {
            stopTimer();
            
            remainingSeconds = totalSeconds;
            startBtn.textContent = '‚ñ∂Ô∏è Start';
            timerDisplay.classList.remove('timer-warning');
            timerStatus.textContent = 'Nh·∫•n Start ƒë·ªÉ b·∫Øt ƒë·∫ßu ƒë·∫øm ng∆∞·ª£c';
            
            updateDisplay();
        }

        // ===== APPLY SETTINGS =====
        function applySettings() {
            if (isRunning) {
                showMessage('Vui l√≤ng d·ª´ng timer tr∆∞·ªõc khi thay ƒë·ªïi c√†i ƒë·∫∑t!', 'error');
                return;
            }

            const minutes = parseInt(document.getElementById('minutesInput').value) || 0;
            const seconds = parseInt(document.getElementById('secondsInput').value) || 0;

            if (minutes < 0 || minutes > 60 || seconds < 0 || seconds > 59) {
                showMessage('Gi√° tr·ªã kh√¥ng h·ª£p l·ªá! Ph√∫t: 0-60, Gi√¢y: 0-59', 'error');
                return;
            }

            totalSeconds = minutes * 60 + seconds;
            
            if (totalSeconds === 0) {
                showMessage('Th·ªùi gian ph·∫£i l·ªõn h∆°n 0!', 'error');
                return;
            }

            remainingSeconds = totalSeconds;
            updateDisplay();
            showMessage(`ƒê√£ c√†i ƒë·∫∑t th·ªùi gian: ${formatTime(totalSeconds)}`, 'success');
        }

        // ===== SHOW TIME UP MODAL =====
        function showTimeUpModal() {
            modal.classList.add('show');
            
            // Play sound (optional - c√≥ th·ªÉ th√™m audio)
            // const audio = new Audio('alarm.mp3');
            // audio.play();
        }

        // ===== CLOSE MODAL =====
        function closeModal() {
            modal.classList.remove('show');
            resetTimer();
        }

        // ===== EVENT LISTENERS =====
        startBtn.addEventListener('click', startTimer);
        pauseBtn.addEventListener('click', pauseTimer);
        resetBtn.addEventListener('click', resetTimer);

        // Click ngo√†i modal ƒë·ªÉ ƒë√≥ng
        modal.addEventListener('click', (e) => {
            if (e.target === modal) {
                closeModal();
            }
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.key === ' ' || e.key === 'Spacebar') {
                e.preventDefault();
                if (isRunning) {
                    pauseTimer();
                } else {
                    startTimer();
                }
            } else if (e.key === 'r' || e.key === 'R') {
                resetTimer();
            }
        });

        // ===== CLEANUP ON PAGE UNLOAD =====
        window.addEventListener('beforeunload', () => {
            // Clear interval khi r·ªùi kh·ªèi trang ƒë·ªÉ tr√°nh memory leak
            if (intervalId) {
                clearInterval(intervalId);
            }
        });

        // ===== INIT =====
        updateDisplay();
    </script>
</body>
</html>
