<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B√†i t·∫≠p 2: Form ƒëƒÉng k√Ω - 710-MSSV</title>
    <link rel="stylesheet" href="css/style.css">
    <style>
        .form-container {
            max-width: 600px;
            margin: 40px auto;
            background: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .form-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .form-header h2 {
            color: #667eea;
            font-size: 2em;
            margin-bottom: 10px;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }

        .form-group label .required {
            color: #e74c3c;
        }

        .form-group input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .form-group input:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .form-group input.invalid {
            border-color: #e74c3c;
        }

        .form-group input.valid {
            border-color: #27ae60;
        }

        .error-message {
            color: #e74c3c;
            font-size: 14px;
            margin-top: 5px;
            display: none;
        }

        .error-message.show {
            display: block;
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .checkbox-group input[type="checkbox"] {
            width: auto;
            cursor: pointer;
        }

        .checkbox-group label {
            margin-bottom: 0;
            cursor: pointer;
            font-weight: normal;
        }

        .submit-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .submit-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }

        .submit-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .password-strength {
            margin-top: 8px;
            height: 5px;
            background: #ddd;
            border-radius: 3px;
            overflow: hidden;
        }

        .password-strength-bar {
            height: 100%;
            width: 0;
            transition: all 0.3s ease;
        }

        .strength-weak { background: #e74c3c; width: 33%; }
        .strength-medium { background: #f39c12; width: 66%; }
        .strength-strong { background: #27ae60; width: 100%; }

        .password-requirements {
            margin-top: 10px;
            font-size: 14px;
            color: #666;
        }

        .password-requirements ul {
            margin-left: 20px;
            margin-top: 5px;
        }

        .password-requirements li {
            margin-bottom: 3px;
        }

        .requirement-met {
            color: #27ae60;
        }

        .requirement-unmet {
            color: #e74c3c;
        }

        .registered-users {
            margin-top: 40px;
            padding: 30px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .registered-users h3 {
            color: #667eea;
            margin-bottom: 20px;
        }

        .user-card {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .user-card strong {
            color: #667eea;
        }

        .clear-storage-btn {
            background: #e74c3c;
            margin-top: 15px;
        }

        .clear-storage-btn:hover {
            background: #c0392b;
        }

        .explanation {
            background: #e8f4f8;
            border-left: 5px solid #667eea;
            padding: 20px;
            margin: 30px 0;
            border-radius: 5px;
        }

        .explanation h3 {
            color: #667eea;
            margin-bottom: 15px;
        }

        .explanation ul {
            margin-left: 20px;
            line-height: 1.8;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üìù B√†i t·∫≠p 2: Form ƒëƒÉng k√Ω ng∆∞·ªùi d√πng</h1>
            <p>Validation v√† l∆∞u tr·ªØ LocalStorage</p>
        </header>

        <nav>
            <ul>
                <li><a href="index.html">üè† Trang ch·ªß</a></li>
                <li><a href="baitap01.html">üì¶ B√†i 1: S·∫£n ph·∫©m</a></li>
                <li><a href="baitap02.html">üìù B√†i 2: Form ƒëƒÉng k√Ω</a></li>
                <li><a href="baitap03.html">‚è±Ô∏è B√†i 3: Countdown</a></li>
                <li><a href="about.html">‚ÑπÔ∏è Gi·ªõi thi·ªáu</a></li>
                <li><a href="contact.html">üìß Li√™n h·ªá</a></li>
            </ul>
        </nav>

        <main>
            <div class="form-container fade-in">
                <div class="form-header">
                    <h2>üéØ ƒêƒÉng k√Ω t√†i kho·∫£n</h2>
                    <p>Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß th√¥ng tin b√™n d∆∞·ªõi</p>
                </div>

                <form id="registrationForm">
                    <div class="form-group">
                        <label for="fullName">
                            H·ªç v√† t√™n <span class="required">*</span>
                        </label>
                        <input 
                            type="text" 
                            id="fullName" 
                            name="fullName" 
                            placeholder="Nguy·ªÖn VƒÉn A"
                            required
                        >
                        <div class="error-message" id="nameError">Vui l√≤ng nh·∫≠p h·ªç t√™n (√≠t nh·∫•t 2 k√Ω t·ª±)</div>
                    </div>

                    <div class="form-group">
                        <label for="email">
                            Email <span class="required">*</span>
                        </label>
                        <input 
                            type="email" 
                            id="email" 
                            name="email" 
                            placeholder="example@email.com"
                            required
                        >
                        <div class="error-message" id="emailError">Email kh√¥ng h·ª£p l·ªá</div>
                    </div>

                    <div class="form-group">
                        <label for="password">
                            M·∫≠t kh·∫©u <span class="required">*</span>
                        </label>
                        <input 
                            type="password" 
                            id="password" 
                            name="password" 
                            placeholder="Nh·∫≠p m·∫≠t kh·∫©u"
                            required
                        >
                        <div class="password-strength">
                            <div class="password-strength-bar" id="strengthBar"></div>
                        </div>
                        <div class="password-requirements">
                            <strong>Y√™u c·∫ßu m·∫≠t kh·∫©u:</strong>
                            <ul id="passwordRequirements">
                                <li class="requirement-unmet" id="req-length">‚úó √çt nh·∫•t 8 k√Ω t·ª±</li>
                                <li class="requirement-unmet" id="req-uppercase">‚úó C√≥ ch·ªØ hoa (A-Z)</li>
                                <li class="requirement-unmet" id="req-lowercase">‚úó C√≥ ch·ªØ th∆∞·ªùng (a-z)</li>
                                <li class="requirement-unmet" id="req-number">‚úó C√≥ s·ªë (0-9)</li>
                            </ul>
                        </div>
                        <div class="error-message" id="passwordError">M·∫≠t kh·∫©u kh√¥ng ƒë√°p ·ª©ng y√™u c·∫ßu</div>
                    </div>

                    <div class="form-group">
                        <label for="confirmPassword">
                            X√°c nh·∫≠n m·∫≠t kh·∫©u <span class="required">*</span>
                        </label>
                        <input 
                            type="password" 
                            id="confirmPassword" 
                            name="confirmPassword" 
                            placeholder="Nh·∫≠p l·∫°i m·∫≠t kh·∫©u"
                            required
                        >
                        <div class="error-message" id="confirmPasswordError">M·∫≠t kh·∫©u kh√¥ng kh·ªõp</div>
                    </div>

                    <div class="form-group checkbox-group">
                        <input 
                            type="checkbox" 
                            id="agreeTerms" 
                            name="agreeTerms"
                            required
                        >
                        <label for="agreeTerms">
                            T√¥i ƒë·ªìng √Ω v·ªõi <a href="#" style="color: #667eea;">ƒêi·ªÅu kho·∫£n s·ª≠ d·ª•ng</a> <span class="required">*</span>
                        </label>
                    </div>
                    <div class="error-message" id="termsError">B·∫°n ph·∫£i ƒë·ªìng √Ω v·ªõi ƒëi·ªÅu kho·∫£n</div>

                    <button type="submit" class="submit-btn">
                        ƒêƒÉng k√Ω ngay
                    </button>
                </form>
            </div>

            <div class="registered-users" id="registeredUsersSection" style="display: none;">
                <h3>üë• Danh s√°ch ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng k√Ω</h3>
                <div id="usersList"></div>
                <button class="submit-btn clear-storage-btn" id="clearStorageBtn">
                    üóëÔ∏è X√≥a t·∫•t c·∫£ d·ªØ li·ªáu
                </button>
            </div>

            <div class="explanation">
                <h3>üí° Logic t∆∞ duy l·∫≠p tr√¨nh</h3>
                <h4>1. X·ª≠ l√Ω s·ª± ki·ªán Submit:</h4>
                <ul>
                    <li><strong>preventDefault():</strong> NgƒÉn form reload trang khi submit</li>
                    <li><strong>Real-time validation:</strong> Ki·ªÉm tra input ngay khi ng∆∞·ªùi d√πng nh·∫≠p</li>
                    <li><strong>Visual feedback:</strong> Hi·ªÉn th·ªã l·ªói/th√†nh c√¥ng b·∫±ng m√†u s·∫Øc v√† th√¥ng b√°o</li>
                </ul>

                <h4>2. Validation logic:</h4>
                <ul>
                    <li><strong>Email:</strong> S·ª≠ d·ª•ng Regex pattern ƒë·ªÉ ki·ªÉm tra format email h·ª£p l·ªá</li>
                    <li><strong>Password:</strong> Ki·ªÉm tra ƒë·ªô d√†i ‚â•8, c√≥ ch·ªØ hoa/th∆∞·ªùng/s·ªë b·∫±ng Regex</li>
                    <li><strong>Password strength:</strong> T√≠nh ƒë·ªô m·∫°nh v√† hi·ªÉn th·ªã progress bar tr·ª±c quan</li>
                    <li><strong>Confirm password:</strong> So s√°nh v·ªõi m·∫≠t kh·∫©u g·ªëc</li>
                </ul>

                <h4>3. B·∫£o m·∫≠t d·ªØ li·ªáu c·ª•c b·ªô (LocalStorage):</h4>
                <ul>
                    <li><strong>Kh√¥ng l∆∞u plain password:</strong> Trong th·ª±c t·∫ø c·∫ßn hash password (bcrypt, SHA-256)</li>
                    <li><strong>JSON stringify/parse:</strong> Chuy·ªÉn ƒë·ªïi object th√†nh string ƒë·ªÉ l∆∞u</li>
                    <li><strong>Array storage:</strong> L∆∞u nhi·ªÅu user d∆∞·ªõi d·∫°ng array trong LocalStorage</li>
                    <li><strong>Timestamp:</strong> L∆∞u th·ªùi gian ƒëƒÉng k√Ω ƒë·ªÉ tracking</li>
                </ul>

                <h4>4. Best practices:</h4>
                <ul>
                    <li>Sanitize input tr∆∞·ªõc khi hi·ªÉn th·ªã ƒë·ªÉ tr√°nh XSS</li>
                    <li>Disable submit button khi ƒëang x·ª≠ l√Ω ƒë·ªÉ tr√°nh double submit</li>
                    <li>Clear form sau khi ƒëƒÉng k√Ω th√†nh c√¥ng</li>
                    <li>Responsive design cho mobile devices</li>
                </ul>
            </div>
        </main>

        <footer>
            <p>&copy; 2026 - B√†i t·∫≠p 2: Form ƒëƒÉng k√Ω | 710-MSSV</p>
        </footer>
    </div>

    <script src="js/script.js"></script>
    <script>
        // ===== VALIDATE EMAIL =====
        function isValidEmail(email) {
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return emailRegex.test(email);
        }

        // ===== VALIDATE PASSWORD =====
        function isValidPassword(password) {
            const hasUpperCase = /[A-Z]/.test(password);
            const hasLowerCase = /[a-z]/.test(password);
            const hasNumber = /[0-9]/.test(password);
            const isLengthValid = password.length >= 8;
            
            return hasUpperCase && hasLowerCase && hasNumber && isLengthValid;
        }

        // ===== CHECK PASSWORD STRENGTH =====
        function checkPasswordStrength(password) {
            let strength = 0;
            const strengthBar = document.getElementById('strengthBar');
            
            // Update requirements
            const reqLength = document.getElementById('req-length');
            const reqUppercase = document.getElementById('req-uppercase');
            const reqLowercase = document.getElementById('req-lowercase');
            const reqNumber = document.getElementById('req-number');

            // Check length
            if (password.length >= 8) {
                strength += 25;
                reqLength.className = 'requirement-met';
                reqLength.textContent = '‚úì √çt nh·∫•t 8 k√Ω t·ª±';
            } else {
                reqLength.className = 'requirement-unmet';
                reqLength.textContent = '‚úó √çt nh·∫•t 8 k√Ω t·ª±';
            }

            // Check uppercase
            if (/[A-Z]/.test(password)) {
                strength += 25;
                reqUppercase.className = 'requirement-met';
                reqUppercase.textContent = '‚úì C√≥ ch·ªØ hoa (A-Z)';
            } else {
                reqUppercase.className = 'requirement-unmet';
                reqUppercase.textContent = '‚úó C√≥ ch·ªØ hoa (A-Z)';
            }

            // Check lowercase
            if (/[a-z]/.test(password)) {
                strength += 25;
                reqLowercase.className = 'requirement-met';
                reqLowercase.textContent = '‚úì C√≥ ch·ªØ th∆∞·ªùng (a-z)';
            } else {
                reqLowercase.className = 'requirement-unmet';
                reqLowercase.textContent = '‚úó C√≥ ch·ªØ th∆∞·ªùng (a-z)';
            }

            // Check number
            if (/[0-9]/.test(password)) {
                strength += 25;
                reqNumber.className = 'requirement-met';
                reqNumber.textContent = '‚úì C√≥ s·ªë (0-9)';
            } else {
                reqNumber.className = 'requirement-unmet';
                reqNumber.textContent = '‚úó C√≥ s·ªë (0-9)';
            }

            // Update strength bar
            strengthBar.className = 'password-strength-bar';
            if (strength <= 25) {
                strengthBar.classList.add('strength-weak');
            } else if (strength <= 75) {
                strengthBar.classList.add('strength-medium');
            } else {
                strengthBar.classList.add('strength-strong');
            }
        }

        // ===== SHOW ERROR =====
        function showError(inputId, errorId, message) {
            const input = document.getElementById(inputId);
            const error = document.getElementById(errorId);
            
            input.classList.add('invalid');
            input.classList.remove('valid');
            error.textContent = message;
            error.classList.add('show');
        }

        // ===== HIDE ERROR =====
        function hideError(inputId, errorId) {
            const input = document.getElementById(inputId);
            const error = document.getElementById(errorId);
            
            input.classList.remove('invalid');
            input.classList.add('valid');
            error.classList.remove('show');
        }

        // ===== SAVE TO LOCALSTORAGE =====
        function saveToLocalStorage(userData) {
            // L·∫•y danh s√°ch user hi·ªán t·∫°i
            let users = JSON.parse(localStorage.getItem('registeredUsers')) || [];
            
            // Ki·ªÉm tra email ƒë√£ t·ªìn t·∫°i
            const emailExists = users.some(user => user.email === userData.email);
            if (emailExists) {
                showMessage('Email n√†y ƒë√£ ƒë∆∞·ª£c ƒëƒÉng k√Ω!', 'error');
                return false;
            }
            
            // Th√™m timestamp
            userData.registeredAt = new Date().toLocaleString('vi-VN');
            
            // Th√™m user m·ªõi
            users.push(userData);
            
            // L∆∞u v√†o LocalStorage
            localStorage.setItem('registeredUsers', JSON.stringify(users));
            
            return true;
        }

        // ===== DISPLAY REGISTERED USERS =====
        function displayRegisteredUsers() {
            const users = JSON.parse(localStorage.getItem('registeredUsers')) || [];
            const section = document.getElementById('registeredUsersSection');
            const usersList = document.getElementById('usersList');

            if (users.length === 0) {
                section.style.display = 'none';
                return;
            }

            section.style.display = 'block';
            usersList.innerHTML = users.map((user, index) => `
                <div class="user-card">
                    <p><strong>T√™n:</strong> ${sanitizeInput(user.fullName)}</p>
                    <p><strong>Email:</strong> ${sanitizeInput(user.email)}</p>
                    <p><strong>Th·ªùi gian:</strong> ${user.registeredAt}</p>
                </div>
            `).join('');
        }

        // ===== CLEAR LOCALSTORAGE =====
        function clearLocalStorage() {
            if (confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a t·∫•t c·∫£ d·ªØ li·ªáu ng∆∞·ªùi d√πng?')) {
                localStorage.removeItem('registeredUsers');
                displayRegisteredUsers();
                showMessage('ƒê√£ x√≥a t·∫•t c·∫£ d·ªØ li·ªáu!', 'info');
            }
        }

        // ===== FORM VALIDATION & SUBMIT =====
        document.getElementById('registrationForm').addEventListener('submit', function(e) {
            e.preventDefault();

            // Get form values
            const fullName = document.getElementById('fullName').value.trim();
            const email = document.getElementById('email').value.trim();
            const password = document.getElementById('password').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            const agreeTerms = document.getElementById('agreeTerms').checked;

            let isValid = true;

            // Validate full name
            if (fullName.length < 2) {
                showError('fullName', 'nameError', 'Vui l√≤ng nh·∫≠p h·ªç t√™n (√≠t nh·∫•t 2 k√Ω t·ª±)');
                isValid = false;
            } else {
                hideError('fullName', 'nameError');
            }

            // Validate email
            if (!isValidEmail(email)) {
                showError('email', 'emailError', 'Email kh√¥ng h·ª£p l·ªá');
                isValid = false;
            } else {
                hideError('email', 'emailError');
            }

            // Validate password
            if (!isValidPassword(password)) {
                showError('password', 'passwordError', 'M·∫≠t kh·∫©u kh√¥ng ƒë√°p ·ª©ng y√™u c·∫ßu');
                isValid = false;
            } else {
                hideError('password', 'passwordError');
            }

            // Validate confirm password
            if (password !== confirmPassword) {
                showError('confirmPassword', 'confirmPasswordError', 'M·∫≠t kh·∫©u kh√¥ng kh·ªõp');
                isValid = false;
            } else {
                hideError('confirmPassword', 'confirmPasswordError');
            }

            // Validate terms
            const termsError = document.getElementById('termsError');
            if (!agreeTerms) {
                termsError.classList.add('show');
                isValid = false;
            } else {
                termsError.classList.remove('show');
            }

            // If all valid, save to LocalStorage
            if (isValid) {
                const userData = {
                    fullName: fullName,
                    email: email,
                    // Trong th·ª±c t·∫ø KH√îNG N√äN l∆∞u password plain text
                    // ƒê√¢y ch·ªâ l√† demo, n√™n l∆∞u password hash
                    passwordHash: btoa(password) // Base64 encode (ch·ªâ demo, kh√¥ng an to√†n)
                };

                if (saveToLocalStorage(userData)) {
                    showMessage('üéâ ƒêƒÉng k√Ω th√†nh c√¥ng! D·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c l∆∞u v√†o LocalStorage.', 'success');
                    
                    // Reset form
                    this.reset();
                    document.querySelectorAll('input').forEach(input => {
                        input.classList.remove('valid', 'invalid');
                    });
                    
                    // Reset password strength
                    document.getElementById('strengthBar').className = 'password-strength-bar';
                    document.querySelectorAll('.requirement-met').forEach(el => {
                        el.className = 'requirement-unmet';
                        el.textContent = el.textContent.replace('‚úì', '‚úó');
                    });

                    // Display updated users list
                    displayRegisteredUsers();
                }
            } else {
                showMessage('‚ùå Vui l√≤ng ki·ªÉm tra l·∫°i th√¥ng tin!', 'error');
            }
        });

        // ===== REAL-TIME VALIDATION =====
        document.getElementById('fullName').addEventListener('input', function() {
            if (this.value.trim().length >= 2) {
                hideError('fullName', 'nameError');
            }
        });

        document.getElementById('email').addEventListener('input', function() {
            if (isValidEmail(this.value.trim())) {
                hideError('email', 'emailError');
            }
        });

        document.getElementById('password').addEventListener('input', function() {
            checkPasswordStrength(this.value);
            if (isValidPassword(this.value)) {
                hideError('password', 'passwordError');
            }
            
            // Check confirm password match
            const confirmPassword = document.getElementById('confirmPassword').value;
            if (confirmPassword && this.value === confirmPassword) {
                hideError('confirmPassword', 'confirmPasswordError');
            }
        });

        document.getElementById('confirmPassword').addEventListener('input', function() {
            const password = document.getElementById('password').value;
            if (this.value === password) {
                hideError('confirmPassword', 'confirmPasswordError');
            }
        });

        document.getElementById('agreeTerms').addEventListener('change', function() {
            const termsError = document.getElementById('termsError');
            if (this.checked) {
                termsError.classList.remove('show');
            }
        });

        // ===== CLEAR STORAGE BUTTON =====
        document.getElementById('clearStorageBtn').addEventListener('click', clearLocalStorage);

        // ===== INIT =====
        document.addEventListener('DOMContentLoaded', () => {
            displayRegisteredUsers();
        });
    </script>
</body>
</html>
